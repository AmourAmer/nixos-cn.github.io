import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as i,o,c as l,a as n,b as e,d as t,e as r}from"./app-Dk79i4wC.js";const c={},p=r(`<h1 id="nixos-的网络问题" tabindex="-1"><a class="header-anchor" href="#nixos-的网络问题"><span>NixOS 的网络问题</span></a></h1><p>国内用户在使用 NixOS 时会存在一些网络问题，一是 NixOS 高度依赖 GitHub 作为 channel/flake<br> 数据源——在国内访问 GitHub 相当的慢，二是 NixOS 官方的包缓存服务器在国内访问速度较慢。</p><p>为了解决这些问题，你可以使用国内的镜像源，或者使用代理工具来加速访问。</p><p>这里我先介绍几个比较简单的配置方法。</p><h2 id="_1-包缓存服务器的加速访问" tabindex="-1"><a class="header-anchor" href="#_1-包缓存服务器的加速访问"><span>1. 包缓存服务器的加速访问</span></a></h2><p>首先，在执行后面给出的任何 <code>nix</code> 相关命令时，你都可以通过 <code>--option</code> 选项来指定镜像源，例<br> 如：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 使用上海交通大学的镜像源</span>
<span class="token comment"># 官方文档: https://mirror.sjtu.edu.cn/docs/nix-channels/store</span>
nixos-rebuild switch <span class="token parameter variable">--option</span> substituters <span class="token string">&quot;https://mirror.sjtu.edu.cn/nix-channels/store&quot;</span>

<span class="token comment"># 使用中国科学技术大学的镜像源</span>
<span class="token comment"># 官方文档: https://mirrors.ustc.edu.cn/help/nix-channels.html</span>
nixos-rebuild switch <span class="token parameter variable">--option</span> substituters <span class="token string">&quot;https://mirrors.ustc.edu.cn/nix-channels/store&quot;</span>

<span class="token comment"># 使用清华大学的镜像源</span>
<span class="token comment"># 官方文档: https://mirrors.tuna.tsinghua.edu.cn/help/nix-channels/</span>
nixos-rebuild switch <span class="token parameter variable">--option</span> substituters <span class="token string">&quot;https://mirrors.tuna.tsinghua.edu.cn/nix-channels/store&quot;</span>

<span class="token comment"># 其他 nix 命令同样可以使用 --option 选项，例如 nix shell</span>
nix shell nixpkgs<span class="token comment">#cowsay --option substituters &quot;https://mirrors.tuna.tsinghua.edu.cn/nix-channels/store&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你可以自己测试下上述几个镜像源的速度，选速度最快的一个。</p><h2 id="_2-channel-flake-的加速访问" tabindex="-1"><a class="header-anchor" href="#_2-channel-flake-的加速访问"><span>2. Channel/Flake 的加速访问</span></a></h2><p>对于 Flake Inputs 跟 Channels 的加速访问，这个就需要使用代理工具加速访问。</p><p>可以通过如下命令设置代理环境变量，实现使用 socks5/http 代理加速 nix 的网络访问：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">mkdir</span> /run/systemd/system/nix-daemon.service.d/
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span>/run/systemd/system/nix-daemon.service.d/override.conf</span>
[Service]
Environment=&quot;https_proxy=socks5h://localhost:7891&quot;
EOF</span>
<span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart nix-daemon
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>但请注意，系统重启后 <code>/run/</code> 目录下的内容会被清空，所以每次重启后都需要重新执行上述命<br> 令</strong>！</p>`,13),d=n("br",null,null,-1),u={href:"https://nixos-and-flakes.thiscute.world/zh/nixos-with-flakes/add-custom-cache-servers",target:"_blank",rel:"noopener noreferrer"},h=n("br",null,null,-1),m={class:"hint-container warning"},b=n("p",{class:"hint-container-title"},"GitHub 报 HTTP 403 错误",-1),x=n("br",null,null,-1),v={href:"https://github.com/ryan4yin/nixos-and-flakes-book/issues/74",target:"_blank",rel:"noopener noreferrer"},k=n("br",null,null,-1),_=n("br",null,null,-1),g={href:"https://github.com/NixOS/nix/issues/6536",target:"_blank",rel:"noopener noreferrer"};function f(N,O){const s=i("ExternalLinkIcon");return o(),l("div",null,[p,n("p",null,[e("更详细的说明与其他用法介绍，请移步"),d,n("a",u,[e("添加自定义缓存服务器"),t(s)]),e(" ，注意这部分"),h,e(" 内容可能需要一定的 NixOS 使用经验才能理解。")]),n("div",m,[b,n("p",null,[e("注意：使用一些商用代理或公共代理时你可能会遇到 GitHub 下载时报 HTTP 403 错误"),x,e(" （"),n("a",v,[e("nixos-and-flakes-book/issues/74"),t(s)]),e("），"),k,e(" 可尝试通过更换代理服务器或者设置"),_,n("a",g,[e("access-tokens"),t(s)]),e(" 来解决。")])])])}const w=a(c,[["render",f],["__file","Networking.html.vue"]]),q=JSON.parse('{"path":"/tutorials/installation/Networking.html","title":"NixOS 的网络问题","lang":"zh-CN","frontmatter":{"description":"NixOS 的网络问题 国内用户在使用 NixOS 时会存在一些网络问题，一是 NixOS 高度依赖 GitHub 作为 channel/flake 数据源——在国内访问 GitHub 相当的慢，二是 NixOS 官方的包缓存服务器在国内访问速度较慢。 为了解决这些问题，你可以使用国内的镜像源，或者使用代理工具来加速访问。 这里我先介绍几个比较简单的配...","head":[["meta",{"property":"og:url","content":"https://nixos-cn.github.io/tutorials/installation/Networking.html"}],["meta",{"property":"og:site_name","content":"NixOS 中文"}],["meta",{"property":"og:title","content":"NixOS 的网络问题"}],["meta",{"property":"og:description","content":"NixOS 的网络问题 国内用户在使用 NixOS 时会存在一些网络问题，一是 NixOS 高度依赖 GitHub 作为 channel/flake 数据源——在国内访问 GitHub 相当的慢，二是 NixOS 官方的包缓存服务器在国内访问速度较慢。 为了解决这些问题，你可以使用国内的镜像源，或者使用代理工具来加速访问。 这里我先介绍几个比较简单的配..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-26T15:35:52.000Z"}],["meta",{"property":"article:author","content":"NixOS-CN"}],["meta",{"property":"article:modified_time","content":"2024-03-26T15:35:52.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"NixOS 的网络问题\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-26T15:35:52.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"NixOS-CN\\",\\"url\\":\\"https://github.com/nixos-cn\\"}]}"]]},"headers":[{"level":2,"title":"1. 包缓存服务器的加速访问","slug":"_1-包缓存服务器的加速访问","link":"#_1-包缓存服务器的加速访问","children":[]},{"level":2,"title":"2. Channel/Flake 的加速访问","slug":"_2-channel-flake-的加速访问","link":"#_2-channel-flake-的加速访问","children":[]}],"git":{"createdTime":1711467352000,"updatedTime":1711467352000,"contributors":[{"name":"Ryan Yin","email":"xiaoyin_c@qq.com","commits":1}]},"readingTime":{"minutes":1.85,"words":555},"filePathRelative":"tutorials/installation/Networking.md","localizedDate":"2024年3月26日","autoDesc":true,"excerpt":"\\n<p>国内用户在使用 NixOS 时会存在一些网络问题，一是 NixOS 高度依赖 GitHub 作为 channel/flake<br>\\n数据源——在国内访问 GitHub 相当的慢，二是 NixOS 官方的包缓存服务器在国内访问速度较慢。</p>\\n<p>为了解决这些问题，你可以使用国内的镜像源，或者使用代理工具来加速访问。</p>\\n<p>这里我先介绍几个比较简单的配置方法。</p>\\n<h2>1. 包缓存服务器的加速访问</h2>\\n<p>首先，在执行后面给出的任何 <code>nix</code> 相关命令时，你都可以通过 <code>--option</code> 选项来指定镜像源，例<br>\\n如：</p>"}');export{w as comp,q as data};
